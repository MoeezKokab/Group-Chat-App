{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useLayoutEffect, useState, useCallback, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { auth, db } from \"./firebase1\";\nimport { AntDesign } from '@expo/vector-icons';\nimport { Avatar } from 'react-native-elements/dist/avatar/Avatar';\nimport { GiftedChat } from 'react-native-gifted-chat';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar Chat = function Chat(props) {\n  var _auth$currentUser2, _auth$currentUser3, _auth$currentUser4;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  useLayoutEffect(function () {\n    var unsubscribe = db.collection('chats').orderBy('createdAt', 'desc').onSnapshot(function (snapshot) {\n      return setMessages(snapshot.docs.map(function (doc) {\n        return {\n          _id: doc.data()._id,\n          createdAt: doc.data().createdAt.toDate(),\n          text: doc.data().text,\n          user: doc.data().user\n        };\n      }));\n    });\n    return unsubscribe;\n  }, []);\n\n  var _onSend = useCallback(function () {\n    var messages = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    setMessages(function (previousMessages) {\n      return GiftedChat.append(previousMessages, messages);\n    });\n    var _messages$ = messages[0],\n        _id = _messages$._id,\n        createdAt = _messages$.createdAt,\n        text = _messages$.text,\n        user = _messages$.user;\n    db.collection('chats').add({\n      _id: _id,\n      createdAt: createdAt,\n      text: text,\n      user: user\n    });\n  }, []);\n\n  useLayoutEffect(function () {\n    props.navigation.setOptions({\n      headerRight: function headerRight() {\n        return _jsx(TouchableOpacity, {\n          onPress: signOut,\n          children: _jsx(AntDesign, {\n            style: {\n              marginRight: 10\n            },\n            name: \"logout\",\n            size: 24,\n            color: \"black\"\n          })\n        });\n      },\n      headerLeft: function headerLeft() {\n        var _auth$currentUser;\n\n        return _jsx(View, {\n          style: {\n            marginLeft: 15,\n            marginBottom: 15,\n            padding: 5\n          },\n          children: _jsx(Avatar, {\n            size: 44,\n            rounded: true,\n            source: {\n              uri: auth == null ? void 0 : (_auth$currentUser = auth.currentUser) == null ? void 0 : _auth$currentUser.photoURL\n            }\n          })\n        });\n      }\n    });\n  }, []);\n\n  var signOut = function signOut() {\n    auth.signOut().then(function () {\n      alert('Sign-out successful');\n      props.navigation.replace('Login');\n    }).catch(function (error) {\n      alert('error');\n    });\n  };\n\n  return _jsx(GiftedChat, {\n    messages: messages,\n    showAvatarForEveryMessage: true,\n    onSend: function onSend(messages) {\n      return _onSend(messages);\n    },\n    user: {\n      _id: auth == null ? void 0 : (_auth$currentUser2 = auth.currentUser) == null ? void 0 : _auth$currentUser2.email,\n      name: auth == null ? void 0 : (_auth$currentUser3 = auth.currentUser) == null ? void 0 : _auth$currentUser3.displayName,\n      avatar: auth == null ? void 0 : (_auth$currentUser4 = auth.currentUser) == null ? void 0 : _auth$currentUser4.photoURL\n    }\n  });\n};\n\nexport default Chat;","map":{"version":3,"sources":["G:/React native/chatApp/Screens/Chat.js"],"names":["React","useLayoutEffect","useState","useCallback","useEffect","auth","db","AntDesign","Avatar","GiftedChat","Chat","props","messages","setMessages","unsubscribe","collection","orderBy","onSnapshot","snapshot","docs","map","doc","_id","data","createdAt","toDate","text","user","onSend","previousMessages","append","add","navigation","setOptions","headerRight","signOut","marginRight","headerLeft","marginLeft","marginBottom","padding","uri","currentUser","photoURL","then","alert","replace","catch","error","email","name","displayName","avatar"],"mappings":"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","sourcesContent":["import React, { useLayoutEffect, useState, useCallback, useEffect } from 'react'\r\nimport { View, Text, TouchableOpacity } from 'react-native'\r\nimport { auth,db } from './firebase1'\r\nimport { AntDesign } from '@expo/vector-icons';\r\nimport { Avatar } from 'react-native-elements/dist/avatar/Avatar';\r\nimport { GiftedChat } from 'react-native-gifted-chat'\r\n\r\nconst Chat = (props) => {\r\n\r\n\r\n    const [messages, setMessages] = useState([]);\r\n\r\n    // useEffect(() => {\r\n    //   setMessages([\r\n    //     {\r\n    //       _id: 1,\r\n    //       text: 'Hello developer',\r\n    //       createdAt: new Date(),\r\n    //       user: {\r\n    //         _id: 2,\r\n    //         name: 'React Native',\r\n    //         avatar: 'https://placeimg.com/140/140/any',\r\n    //       },\r\n    //     },\r\n    //   ])\r\n    // }, [])\r\n\r\n    useLayoutEffect(() => {\r\n        const unsubscribe = db.collection('chats').orderBy('createdAt', 'desc').onSnapshot(snapshot => setMessages(\r\n            snapshot.docs.map(doc => ({\r\n                _id: doc.data()._id,\r\n                createdAt: doc.data().createdAt.toDate(),\r\n                text: doc.data().text,\r\n                user: doc.data().user\r\n            }))\r\n        ))\r\n        return unsubscribe;\r\n\r\n    }, [])\r\n  \r\n    const onSend = useCallback((messages = []) => {\r\n      setMessages(previousMessages => GiftedChat.append(previousMessages, messages))\r\n      const {\r\n          _id,\r\n          createdAt,text,user\r\n      }=messages[0]\r\n      db.collection('chats').add({\r\n        _id,createdAt,text,user\r\n      })\r\n\r\n    }, [])\r\n  \r\n\r\n\r\n    useLayoutEffect(() => {\r\n        props.navigation.setOptions({\r\n            headerRight: () => (\r\n                <TouchableOpacity onPress={signOut}>\r\n\r\n                    <AntDesign style={{ marginRight: 10 }} name=\"logout\" size={24} color=\"black\" />\r\n                </TouchableOpacity>),\r\n            headerLeft: () => (<View style={{ marginLeft: 15 ,marginBottom:15,padding:5}}>\r\n                <Avatar\r\n                    size={44}\r\n                    rounded\r\n                    source={{ uri: auth?.currentUser?.photoURL }}\r\n                />\r\n\r\n            </View>)\r\n\r\n\r\n        })\r\n\r\n\r\n    }, [])\r\n    const signOut = () => {\r\n        auth.signOut().then(() => {\r\n            // Sign-out successful.\r\n            alert('Sign-out successful')\r\n            props.navigation.replace('Login')\r\n        }).catch((error) => {\r\n            // An error happened.\r\n            alert('error')\r\n        })\r\n    }\r\n\r\n\r\n    return (\r\n        <GiftedChat\r\n        messages={messages}\r\n        showAvatarForEveryMessage={true}\r\n        onSend={messages => onSend(messages)}\r\n        user={{\r\n          _id: auth?.currentUser?.email,\r\n          name:auth?.currentUser?.displayName,\r\n          avatar:auth?.currentUser?.photoURL\r\n        }}\r\n      />\r\n    )\r\n}\r\n\r\nexport default Chat\r\n\r\n"]},"metadata":{},"sourceType":"module"}